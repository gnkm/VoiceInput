# VoiceInput システム要件仕様書 (SRS)

## 1. はじめに (Introduction)

### 1.1 目的 (Purpose)
本文書は、**VoiceInput** アプリケーションのシステム要件を定義することを目的とする。本文書では、クロスプラットフォームかつローカル完結型の音声入力ソリューションに対するユーザーのニーズを満たすための、ソフトウェアの機能要件および非機能要件を規定する。

### 1.2 範囲 (Scope)
VoiceInput アプリケーションは、複数のオペレーティングシステム (Windows/PC, macOS, Linux) での音声テキスト入力を容易にするデスクトップユーティリティである。本システムは主にバックグラウンドで動作し、グローバルホットキーを使用して音声認識の有効化および無効化を行う。プライバシーと低レイテンシを確保するため、クラウドサービスに依存せず、ローカルの機械学習モデルを活用する。

### 1.3 製品概要 (Product Overview)
VoiceInput は「キーボード代替」ツールとして機能する。起動されると、ユーザーの音声をインターセプトし、ローカルで実行される OpenAI Whisper エンジンを使用してテキストに変換し、ユーザー定義のフォーマット指示を適用した後、結果のテキストを現在アクティブなウィンドウに入力する。

### 1.4 定義、頭字語、および略語 (Definitions, Acronyms, and Abbreviations)
- **SRS**: System Requirements Specification (システム要件仕様書)
- **OS**: Operating System (オペレーティングシステム)
- **UI**: User Interface (ユーザーインターフェース)
- **STT**: Speech-to-Text (音声文字変換)

## 2. 参照 (References)
- **ISO/IEC/IEEE 29148:2018**: Systems and software engineering — Life cycle processes — Requirements engineering
- **OpenAI Whisper**: https://github.com/openai/whisper
- **Flutter**: https://flutter.dev/

## 3. 詳細要件 (Specific Requirements)

### 3.1 機能要件 (Functional Requirements)

#### 3.1.1 バックグラウンド実行 (Background Execution)
- **REQ-FUN-001**: システムは起動時にバックグラウンドプロセスとして実行され、主要な操作のために永続的なフォアグラウンドウィンドウを必要としないこと。

#### 3.1.2 起動フック (Activation Hook)
- **REQ-FUN-002**: システムは、ユーザーが定義した特定のグローバルキーの組み合わせ（ホットキー）を監視すること。
- **REQ-FUN-003**: 起動ホットキーの検出時に、システムは「音声入力モード」に移行すること。

#### 3.1.3 音声入力と文字起こし (Voice Input and Transcription)
- **REQ-FUN-004**: 音声入力モード中、システムはユーザーが選択したマイクから音声入力をキャプチャすること。
- **REQ-FUN-005**: システムは、ローカルの OpenAI Whisper インスタンスを使用して、キャプチャされた音声に対してリアルタイムで音声文字変換 (STT) を実行すること。

#### 3.1.4 無効化とテキスト挿入 (Deactivation and Text Insertion)
- **REQ-FUN-006**: 起動ホットキーの2回目の押下（または個別の無効化ホットキーの押下）時に、システムは音声入力モードを終了すること。
- **REQ-FUN-007**: 音声入力モードの終了時に、システムは文字起こしを確定させること。
- **REQ-FUN-008**: システムは、文字起こしされたテキストを、キーストロークのシミュレーションまたはクリップボードへの貼り付けによって、現在フォーカスされているアプリケーションに入力すること。

#### 3.1.5 文字起こしヒント / コンテキスト (Transcription Hints / Context)
- **REQ-FUN-009**: システムは、ユーザーが「文字起こしヒント」（例：専門用語、人名、文体、表記の好み）を定義できるようにすること。
- **REQ-FUN-010**: システムは、設定されたヒントを音声認識エンジン (Whisper) の初期プロンプトとして使用し、認識精度と出力スタイルを調整すること。

#### 3.1.6 ローカル推論パフォーマンス (Local Inference Performance)
- **REQ-FUN-011**: システムは、音声データを外部サーバーに送信することなく、OpenAI Whisper モデルを完全にローカルマシン (CPU/GPU) 上で実行すること。可能な限りファイル保存を行わず、オンメモリでのストリーミング処理を採用すること。

#### 3.1.7 モデル選択 (Model Selection)
- **REQ-FUN-012**: システムは、パフォーマンスと精度のバランスをとるために、ユーザーが異なるサイズやバリエーションの Whisper モデル（例：`tiny`, `base`, `small`, `medium`, `large`）を選択できるインターフェースを提供すること。

#### 3.1.8 システムフィードバック (System Feedback)
- **REQ-FUN-013**: システムは、アプリケーションの現在の状態（待機中、録音中、処理中）を視覚的に、システムトレイアイコンの変化によってユーザーに通知すること。
- **REQ-FUN-014**: システムは、音声入力中に現在認識されているテキストをリアルタイムで画面上（フローティングウィンドウ）に表示すること。

### 3.2 外部インターフェース要件 (External Interface Requirements)

#### 3.2.1 ユーザーインターフェース (User Interfaces)
- **REQ-UI-001**: システムは、以下を設定するための設定ウィンドウまたはトレイメニューを提供すること：
    - グローバルホットキー
    - Whisper モデルの選択
    - 文字起こしヒント（初期プロンプト）
    - 音声入力デバイス
- **REQ-UI-002**: システムは、Whisper モデルのダウンロード状態を可視化し、管理するための UI（モデル管理画面）を提供すること。
    - 各モデルのダウンロード状況（進捗率）の表示
    - ダウンロードの手動開始とキャンセル
    - ダウンロード済みモデルの削除機能

#### 3.2.2 ハードウェアインターフェース (Hardware Interfaces)
- **REQ-HW-001**: システムは、ホスト OS によって認識される標準的な音声入力デバイス（マイク）とインターフェースすること。

#### 3.2.3 ソフトウェアインターフェース (Software Interfaces)
- **REQ-SW-001**: システムは、**Flutter** で構築されたクライアントアプリケーションで構成されること。
- **REQ-SW-002**: システムは、**Windows**、**macOS**、および **Linux** オペレーティングシステムと互換性があること。

### 3.3 システム属性 (System Attributes)

#### 3.3.1 プライバシー (Privacy)
- **REQ-PRIV-001**: すべての音声処理データは、ユーザーのローカルデバイス上に留まること。

#### 3.3.2 移植性 (Portability)
- **REQ-PORT-001**: アプリケーションコードは、プラットフォーム固有の偏差を最小限に抑えるために、クロスプラットフォームのコードベース (Dart/Flutter) で維持されること。
